(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[944],{2471:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var a=n(159),o=n(219),r=(n(7294),n(3905)),i=["components"],l={};function s(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"fetch"},"Fetch"),(0,r.kt)("p",null,"Fetch is a component that exposes a declarative interface for the ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," API.\nIts main job is to translate the promise state of a fetch operation into\nconsumable props. It also provides methods to read, invalidate, and refresh\nfetch states."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"React.Component<FetchProps, FetchState>\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The Fetch component is designed to work with ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," requests. This is for 2 reasons:"),(0,r.kt)("ol",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"GET")," requests are typically\n",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Glossary/safe"},"safe"),", and\n",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Glossary/cacheable"},"cacheable"),"."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"POST"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"PUT"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"PATCH"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"DELETE")," methods are typically reserved for\noperations that modify state on the server. In UI terms, these actions\nusually require user interaction, e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"onClick"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"onSubmit"),".")),(0,r.kt)("p",{parentName:"blockquote"},"To make additional operations for a particular endpoint available to\nchildren, consider using a Resource component.")),(0,r.kt)("h2",{id:"props"},"Props"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"type FetchProps = {\n  url: string,\n  options: RequestOptions,\n  maxAge: number,\n  children?: (FetchState) => React.Node,\n\n  /* advanced options */\n  cache: CacheState,\n  fetcher: Fetcher,\n};\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("inlineCode",{parentName:"p"},"maxAge")," is the maximum ",(0,r.kt)("strong",{parentName:"p"},"number of seconds")," since last resolved that a cached\nresult will be considered acceptable. The fetcher will always look in the cache\nfirst. If the result is not found, or the last resolved timestamp is outside the\nmaximum allowed, the fetcher will automatically refresh the result.")),(0,r.kt)("h2",{id:"fetchstate"},"FetchState"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"type FetchState = {\n  pending: boolean,\n  rejected: boolean,\n  fulfilled: boolean,\n  value: ?any,\n  reason: ?Error\n  invalidate: () => void,\n  read: () => void,\n  refresh: () => void\n};\n")),(0,r.kt)("h2",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'import React from "react";\n\nexport default () => {\n  const url = `https://api.example.com/users`;\n  const options = {\n    method: "GET",\n    headers: {\n      "Content-Type": "application/json; charset=UTF-8",\n    },\n  };\n  const maxAge = 60 * 60; // 1 hour\n\n  return (\n    <Fetch url={url} options={options} maxAge={maxAge}>\n      {(fetchState) => {\n        if (fetchState.pending) return "Loading...";\n\n        if (fetchState.rejected) return "Error";\n\n        const users = fetchState.value.data;\n\n        return (\n          <>\n            <button onClick={fetchState.read}>Read</button>\n            <button onClick={fetchState.invalidate}>Invalidate</button>\n            <button onClick={fetchState.refresh}>Refresh</button>\n            <ul>\n              {users.map((user) => (\n                <li key={user.id}>{user.name}</li>\n              ))}\n            </ul>\n          </>\n        );\n      }}\n    </Fetch>\n  );\n};\n')))}s.isMDXComponent=!0},641:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/api/fetch",function(){return n(2471)}])}},function(e){e.O(0,[774,888,179],(function(){return t=641,e(e.s=t);var t}));var t=e.O();_N_E=t}]);